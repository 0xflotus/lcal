<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>dcal.sh - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/darkfish.js"></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="../AUTHOR.html">AUTHOR</a>
  
    <li><a href="../COPYING.html">COPYING</a>
  
    <li><a href="../README.html">README</a>
  
    <li><a href="../make_sh.html">make.sh</a>
  
    <li><a href="../man/rcal_1.html">rcal.1</a>
  
    <li><a href="../man/rcal_1_ronn.html">rcal.1.ronn</a>
  
    <li><a href="../rcal_gemspec.html">rcal.gemspec</a>
  
    <li><a href="../scripts/dcal_sh.html">dcal.sh</a>
  
    <li><a href="../scripts/ddate_sh.html">ddate.sh</a>
  
    <li><a href="../scripts/gd_conversion_sh.html">gd_conversion.sh</a>
  
    <li><a href="../scripts/gdj_conversion_sh.html">gdj_conversion.sh</a>
  
    <li><a href="../scripts/rcal-funcs_sh.html">rcal-funcs.sh</a>
  
    <li><a href="../scripts/rcalhtml_sh.html">rcalhtml.sh</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page scripts/dcal.sh">

<p>#!/bin/bash - # # SCRIPT: dcal.sh # AUTHOR: Luciano D. Cecere # DATE:
06/21/2015-04:44:01 PM
######################################################################## #
# dcal.sh - Generate Discordian <a href="../Calendar.html">Calendar</a> #
Copyright (C) 2015 Luciano D. Cecere &lt;ldante86@aol.com&gt; # # This
program is free software: you can redistribute it and/or modify # it under
the terms of the GNU General Public License as published by # the Free
Software Foundation, either version 2 of the License, or # (at your option)
any later version. # # This program is distributed in the hope that it will
be useful, # but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the # GNU
General Public License for more details. # # You should have received a
copy of the GNU General Public License # along with this program.  If not,
see &lt;<a
href="http://www.gnu.org/licenses">www.gnu.org/licenses</a>/&gt;. #
########################################################################</p>

<p>export PATH=/bin:/usr/bin unalias -a PROGRAM=“${0##*/}”</p>

<p>WEEKDAY=(Sweetmorn Boomtime Pungenday Prickle-Prickle “Setting Orange”)
APOSTLE=(Mungday Mojoday Syaday Zaraday Maladay) HOLYDAY=(Chaoflux
Discoflux Confuflux Bureflux Afflux) SEASONS=(Chaos Discord Confusion
Bureaucracy “The Aftermath”)</p>

<p>TIB=0</p>

<p>month_len() {</p>

<pre>case $1 in
  4|6|9|11        )  echo 30 ;;
  1|3|5|7|8|10|12 )  echo 31 ;;
  2)
    if [[ $(($2 % 4)) -eq 0 &amp;&amp; $(($2 % 100)) -ne 0 || $(($2 % 400)) -eq 0 ]]; then
      echo 29
    else
      echo 28
    fi
    ;;
esac</pre>

<p>}</p>

<p>ordinal() {</p>

<pre>case ${1:$((${#1}-2)):2} in
  [2-9][1]|1  )  echo ${1}st ;;
  [2-9][2]|2  )  echo ${1}nd ;;
  [2-9][3]    )  echo ${1}rd ;;
  [1][1-9]|*  )  echo ${1}th ;;
esac</pre>

<p>}</p>

<p>discordian_date() {</p>

<pre>M=${1:-$(date +%_m)}
D=${2:-$(date +%_d)}
YEAR=${3:-$(date +%Y)}
Y=$(( ${3:-$(date +%Y)} + 1166 ))

if [ $M -gt 12 ]; then
  echo Month out of range of year
  exit 1
fi

if [ $D -gt $(month_len $M $YEAR) -o $D -le 0 ]; then
  echo Day out of range of month
  exit 1
fi

if [ $(month_len $M $YEAR) -eq 29 -a $M -eq 2 -a $D -eq 29 ]; then
  echo &quot;St. Tib&#39;s Day, $Y YOLD&quot;
  TIB=1
fi

days=$D

for (( m=1; m&lt;$M; m++ ))
do
  ((days+=$(month_len $m $YEAR)))
done

dayofyear=$days

if [ $(month_len 2 $YEAR) -eq 29 -a $dayofyear -ge 60 ]; then
  ((--dayofyear))
fi

seasonday=$(( dayofyear % 73 ))
[ $seasonday -eq 0 ] &amp;&amp; seasonday=73

case $seasonday in
  5)  echo Today is &quot;${APOSTLE[$((dayofyear / 73))]}&quot;, in the YOLD $Y
      season=&quot;${SEASONS[$((dayofyear / 73))]}&quot;
      ;;
 50)  echo Today is &quot;${HOLYDAY[$((dayofyear / 73))]}&quot;, in the YOLD $Y
      season=&quot;${SEASONS[$((dayofyear / 73))]}&quot;
      ;;
  *)  case $dayofyear in
        73|146|219|291|365)  season=&quot;${SEASONS[$((dayofyear / 73))-1]}&quot; ;;
        *)                   season=&quot;${SEASONS[$((dayofyear / 73))]}&quot; ;;
      esac
      ;;
esac

dayofweek=&quot;${WEEKDAY[$(( (dayofyear-1) % 5 ))]}&quot;</pre>

<p>}</p>

<p>compile_discordian() {</p>

<pre>case $season in
  Chaos           )  true                           ;;
  Discord         )  echo -n &quot;xxxx xxxx xxxx &quot;      ;;
  Confusion       )  echo -n &quot;xxxx &quot;                ;;
  Bureaucracy     )  echo -n &quot;xxxx xxxx xxxx xxxx &quot; ;;
  &quot;The Aftermath&quot; )  echo -n &quot;xxxx xxxx &quot;           ;;
esac

for i in {1..73}
do
  if [ $i -lt 10 ]; then
    if [ $i -eq 5 ]; then
      echo -n &quot;xx*5 &quot;
    else
      echo -n &quot;xxx$i &quot;
    fi
  elif [ $i -eq 50 ]; then
    echo -n &quot;x*50 &quot;
  else
    echo -n &quot;xx$i &quot;
  fi
done</pre>

<p>}</p>

<p>show_discordian() {</p>

<pre>BO=$(tput smso)
LD=$(tput rmso)
TODAY=$seasonday
[ ${#TODAY} -eq 1 ] &amp;&amp; TODAY=xxx${TODAY}
[ ${#TODAY} -eq 2 ] &amp;&amp; TODAY=xx${TODAY}

if [ $TIB -eq 1 ]; then
  BOLD_TODAY=$TODAY
else
  BOLD_TODAY=${BO}${TODAY}${LD}
fi

if [ $seasonday -eq 5 ]; then
  TODAY=&quot;*5 &quot;
  BOLD_TODAY=${BO}${TODAY}${LD}
fi

if [ $seasonday -eq 50 ]; then
  TODAY=&quot;*50&quot;
  BOLD_TODAY=${BO}${TODAY}${LD}
fi

row=$(compile_discordian)

echo
echo &quot;     $season $Y&quot;
echo &quot;  SM   BT   PD   PP   SO&quot;

for i in {0..375..25}
do
  [ &quot;X${row:i:25}&quot; == &quot;X&quot; ] &amp;&amp; break
  echo &quot;${row:i:25}&quot; | sed &quot;s/$TODAY/$BOLD_TODAY/&quot; |  sed &#39;s/x/ /g&#39;
done
echo</pre>

<p>}</p>

<p>### BEGIN PROGRAM ###</p>

<p>case $1 in</p>

<pre>-d)
  shift
  discordian_date &quot;$@&quot;
  [ $TIB -eq 1 ] &amp;&amp; exit 0
  echo -n &quot;Today is $dayofweek, the $(ordinal $seasonday) &quot;
  echo &quot;day of $season in the YOLD $Y&quot;
  ;;
-*|*[a-z]*)
  echo Invalid option \&#39;${1:1}\&#39;
  exit 1
  ;;
*)
  discordian_date &quot;$@&quot;
  show_discordian | while read
                    do
                      echo &quot;     $REPLY&quot;
                    done</pre>

<p>esac</p>

<p>### EOF ###</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

